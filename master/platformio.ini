; ============================================================================
; PlatformIO Configuration - Master Arduino (Telemetry Logger)
; ============================================================================
; Full-featured telemetry system with CAN, GPS, SD card logging
; ============================================================================

[platformio]
default_envs = nano_atmega328

[env:nano_atmega328]
platform = atmelavr
board = nanoatmega328
framework = arduino

; Include shared libraries from root lib folder
lib_extra_dirs = ../lib

; Serial monitor
monitor_speed = 115200
monitor_filters = default, time

; Build flags
build_flags = 
    -DARDUINO_NANO
    -DMCP2515_CRYSTAL_8MHZ
    -Wall
    -Wextra
    -Os
    -flto
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections
    -Wl,--relax

; Library dependencies
lib_deps = 
    coryjfowler/MCP_CAN@^1.5.1
    mikalhart/TinyGPSPlus@^1.1.0
    greiman/SdFat@^2.2.3

; Ignore LED rendering library (moved to slave Arduino)
lib_ignore = 
    LEDController

; Upload settings
upload_protocol = arduino
upload_speed = 115200

; ============================================================================
; Old Bootloader (for clone Nanos)
; ============================================================================
[env:nano_old_bootloader]
platform = atmelavr
board = nanoatmega328
framework = arduino
board_upload.speed = 57600

; Include shared libraries from root lib folder
lib_extra_dirs = ../lib

monitor_speed = 115200
monitor_filters = default, time

build_flags = 
    -DARDUINO_NANO
    -DMCP2515_CRYSTAL_8MHZ
    -Wall
    -Wextra
    -Os
    -flto
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections
    -Wl,--relax

lib_deps = 
    coryjfowler/MCP_CAN@^1.5.1
    mikalhart/TinyGPSPlus@^1.1.0
    greiman/SdFat@^2.2.3

; Ignore LED libraries (LED rendering moved to slave Arduino)
lib_ignore = 
    LEDController

upload_protocol = arduino
upload_speed = 57600
