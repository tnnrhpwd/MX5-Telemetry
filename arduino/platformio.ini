; PlatformIO Project Configuration File
;
; MX5-Telemetry Single Arduino Setup
; ===================================
; Optimized single Arduino configuration for CAN bus reading and LED control
; Eliminates inter-Arduino communication delay for fastest RPM-to-LED response
;
; Upload Instructions (manual reset required for CH340 Nano clones):
;   1. Hold RESET button on Arduino
;   2. Run: pio run -t upload
;   3. When you see "Uploading", release RESET
;
; Or use the helper script: .\upload_single.ps1

[env:nano]
platform = atmelavr
board = nanoatmega328
framework = arduino

; Upload settings for new bootloader (115200 baud)
upload_protocol = arduino
upload_port = COM5
upload_speed = 115200

; Build optimizations for maximum speed and minimum flash usage
build_flags = 
    -Os                          ; Optimize for size
    -DLED_COUNT=20               ; Number of LEDs in strip
    -DCAN_INTERRUPT_PIN=2        ; MCP2515 INT pin (use hardware interrupt)
    -DF_CPU=16000000L            ; Ensure 16MHz operation

; Required libraries
lib_deps = 
    ; MCP2515 CAN Bus Controller - lean and fast
    coryjfowler/mcp_can@^1.5.0
    ; WS2812B LED Control - optimized NeoPixel library
    adafruit/Adafruit NeoPixel@^1.12.0

; Monitor settings for debugging
monitor_speed = 115200
monitor_filters = 
    direct
    time
